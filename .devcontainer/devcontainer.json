// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/docker-existing-docker-compose
{
	"name": "Apache Airflow Lab (v3)",
	"image": "mcr.microsoft.com/devcontainers/universal:2",
	// "build": {
	// 	"dockerfile": "Dockerfile",
	//	"context": "..",
	// 	"args": {
	// 		"AIRFLOW_IMAGE_VERSION": "3.0.6"
	// 	}
	// },
	"postCreateCommand": "mkdir -p ./dags ./logs ./plugins ./config && echo -e AIRFLOW_UID=$(id -u) > '.env' && docker compose -f ./docker-compose.yaml up -d",
	"postStartCommand": "docker compose -f ./docker-compose.yaml start",

	// Minimum host requirements https://containers.dev/implementors/json_reference/#min-host-reqs
	"hostRequirements": {
		"cpus": 4,
		"memory": "16gb",
		"storage": "32gb",
		"gpu": false
	}
}
